# Data Exfiltration Detection
**Date:** 2026-01-31

**Objective:**
- detect exfiltration attempts using network traffic analysis.
- Identify signs of exfiltration on endpoint devices.
- Correlate logs in a SIEM to uncover hidden exfiltration channels.


**Environment:** TryHackMe – “Data Exfiltration Detection” room  
**Tools Used:** Wireshark, eSplunk

<img width="1440" height="621" alt="Screenshot 2026-02-01 at 7 49 13 AM" src="https://github.com/user-attachments/assets/9ac439cf-d321-448b-99fc-a83e6c42efbb" />
- Time must be set to "All time" once selecting a file to work in

## Identifying DNS Exfiltration Through Wireshark

Upon filtering for "dns", there are a few things that can be identified:
<img width="1440" height="768" alt="Screenshot 2026-02-01 at 8 25 40 AM" src="https://github.com/user-attachments/assets/63a69d6e-9ec6-452a-85f5-f5b5f0605e7a" />
- The external domain name contains jumbled characters prior to the actual domain unlike some of the other domains such as "github.com" or "stackoverflow.com"
- The query length is larger than the others with regular-looking domain names on average
- Multiple internal IPs are contacting this external domain


To support this, I can search for query legnths greater than the typical amount
<img width="1440" height="645" alt="Screenshot 2026-02-01 at 8 39 13 AM" src="https://github.com/user-attachments/assets/92f74df7-d200-4c55-92f5-0b4e786d50bd" />

The query name can also be filtered for
<img width="1440" height="645" alt="Screenshot 2026-02-01 at 8 50 12 AM" src="https://github.com/user-attachments/assets/54fdd924-0bc4-4710-b6f8-dc6707bd22bd" />


## Identifying DNS Exfiltration Through Splunk

### Displaying stats generated by IP
<img width="1440" height="572" alt="Screenshot 2026-02-01 at 9 23 42 AM" src="https://github.com/user-attachments/assets/9436d1a8-8f80-4a9b-ae36-00cc5c7dfd4a" />


### Displaying queried sites
<img width="1440" height="764" alt="Screenshot 2026-02-01 at 9 25 35 AM" src="https://github.com/user-attachments/assets/447c27fb-c8d8-4d85-affe-381715471bc5" />

